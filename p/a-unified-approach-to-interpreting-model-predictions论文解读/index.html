<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="SHAPå€¼æ˜¯ä¸€ç§å¤æ‚æ¨¡å‹è§£é‡Šæ–¹æ³•ï¼Œå®ƒçš„è®¡ç®—åŸç†æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ"><title>ã€ŠA Unified Approach to interpreting Model Predictionsã€‹è®ºæ–‡è§£è¯»</title><link rel=canonical href=https://jmwyf.github.io/p/a-unified-approach-to-interpreting-model-predictions%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/><link rel=stylesheet href=/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css><meta property="og:title" content="ã€ŠA Unified Approach to interpreting Model Predictionsã€‹è®ºæ–‡è§£è¯»"><meta property="og:description" content="SHAPå€¼æ˜¯ä¸€ç§å¤æ‚æ¨¡å‹è§£é‡Šæ–¹æ³•ï¼Œå®ƒçš„è®¡ç®—åŸç†æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ"><meta property="og:url" content="https://jmwyf.github.io/p/a-unified-approach-to-interpreting-model-predictions%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/"><meta property="og:site_name" content="ä»ç™¾è‰å›­åˆ°ä¸‰å‘³ä¹¦å±‹"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="machine learning"><meta property="article:tag" content="SHAP"><meta property="article:published_time" content="2023-01-06T16:59:00+00:00"><meta property="article:modified_time" content="2023-01-06T16:59:00+00:00"><meta name=twitter:title content="ã€ŠA Unified Approach to interpreting Model Predictionsã€‹è®ºæ–‡è§£è¯»"><meta name=twitter:description content="SHAPå€¼æ˜¯ä¸€ç§å¤æ‚æ¨¡å‹è§£é‡Šæ–¹æ³•ï¼Œå®ƒçš„è®¡ç®—åŸç†æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-133677720-1","auto"),ga("send","pageview"))</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_huee84e2c56840f3483a5fc1306f905ef2_56463_300x0_resize_box_3.png width=300 height=274 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>ä»ç™¾è‰å›­åˆ°ä¸‰å‘³ä¹¦å±‹</a></h1><h2 class=site-description>é¡ä¸æœ‰åˆï¼Œé²œå…‹æœ‰ç»ˆ.</h2></div></header><ol class=social-menu><li><a href target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://jmwyf.github.io/ selected>English</option><option value=https://jmwyf.github.io/zh-cn/>ä¸­æ–‡</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#introduction>Introduction</a></li><li><a href=#interpretation-model-properties>Interpretation model properties</a></li><li><a href=#additive-feature-attribution-methods>Additive Feature Attribution methods</a></li><li><a href=#classic-shapley-value-estimation>Classic Shapley Value Estimation</a></li><li><a href=#shap>SHAP</a></li><li><a href=#kernel-shap>Kernel SHAP</a><ol><li><a href=#lime>LIME</a></li><li><a href=#kernelshaplinear-lime--shapley-value>KernelSHAPï¼ˆLinear LIME + Shapley valueï¼‰</a></li></ol></li><li><a href=#deep-shap>Deep SHAP</a><ol><li><a href=#deepliftlearning-important-features>DeepLIFTï¼ˆLearning Important FeaTuresï¼‰</a></li><li><a href=#deepshapdeeplift--shapley-value>DeepSHAP(DeepLIFT + Shapley value)</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/paper/>Paper</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/a-unified-approach-to-interpreting-model-predictions%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/>ã€ŠA Unified Approach to interpreting Model Predictionsã€‹è®ºæ–‡è§£è¯»</a></h2><h3 class=article-subtitle>SHAPå€¼æ˜¯ä¸€ç§å¤æ‚æ¨¡å‹è§£é‡Šæ–¹æ³•ï¼Œå®ƒçš„è®¡ç®—åŸç†æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jan 06, 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><h1 id=a-unified-approach-to-interpreting-model-predictionsè®ºæ–‡è§£è¯»>ã€ŠA Unified Approach to Interpreting Model Predictionsã€‹è®ºæ–‡è§£è¯»</h1><h2 id=introduction>Introduction</h2><ul><li>å¤§æ•°æ®è®©å¤æ‚æ¨¡å‹çš„ä¼˜åŠ¿æ˜æ˜¾</li><li>æå‡ºä¸€ç§æ–°é¢–ç»Ÿä¸€çš„æ–¹æ³•ç”¨äºæ¨¡å‹è§£é‡Š<ul><li>ç”¨æ¨¡å‹çš„æ–¹æ³•æ¥è§£é‡Šå¤æ‚æ¨¡å‹ï¼ˆç”¨é­”æ³•æ‰“è´¥é­”æ³•ï¼‰</li><li>æå‡ºSHAPå€¼ä½œä¸ºå„ç§æ–¹æ³•è¿‘ä¼¼ç»Ÿä¸€ç‰¹å¾é‡è¦åº¦åº¦é‡</li><li>æå‡ºæ–°çš„SHAPå€¼ä¼°è®¡æ–¹æ³•</li></ul></li></ul><h2 id=interpretation-model-properties>Interpretation model properties</h2><p>æè¿°è§£é‡Šæ¨¡å‹éœ€è¦æœ‰çš„ä¸‰ä¸ªæ€§è´¨ï¼Œè€Œç°åœ¨è§£é‡Šæ–¹æ³•çš„ç¼ºé™·æœ‰å“ªäº›<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><ul><li>å±€éƒ¨å‡†ç¡®æ€§ï¼šå¦‚æœxâ€˜æ˜¯xçš„ç®€åŒ–ç‰¹å¾ï¼Œå¯¹åº”è§£é‡Šæ¨¡å‹g(x&rsquo;) = f(x)ï¼Œå³è§£é‡Šæ¨¡å‹åœ¨ç»™å®šçš„ç‰¹å¾æƒ…å†µä¸‹èƒ½è§£é‡Šä¸ºä»€ä¹ˆæ¨¡å‹é¢„æµ‹å€¼æ˜¯è¿™ä¹ˆå¤šã€‚</li><li>ç¼ºå¤±æ€§ï¼šå½“x&rsquo;=0çš„æ—¶å€™ï¼Œè´¡çŒ®åº¦$\phi$ä¸º0</li><li>ä¸€è‡´æ€§ï¼šæ¨¡å‹æ”¹å˜å¯¼è‡´ç‰¹å¾å˜çš„æ›´é‡è¦æ—¶ï¼Œè´¡çŒ®åº¦ä¹Ÿåº”è¯¥å˜å¤§</li></ul><h2 id=additive-feature-attribution-methods>Additive Feature Attribution methods</h2><p>ä¸€å¤§ç±»æ–¹æ³•ä¸­è§£é‡Šæ¨¡å‹æ˜¯ä¸€ç³»åˆ—äºŒå…ƒå˜é‡çš„çº¿æ€§å‡½æ•°
ç§°ä¸º<strong>Additive Feature Attribution methods</strong>ï¼ˆAFAï¼‰ç›¸åŠ ç‰¹å¾å½’å› æ–¹æ³•
$$g(z&rsquo;) = \phi_0 + \sum_{i=1}^{M}\phi_i z&rsquo;_{i}$$
$z&rsquo; \in {0, 1}^M$</p><h2 id=classic-shapley-value-estimation>Classic Shapley Value Estimation</h2><p>$$\phi_{i} = \sum_{S \subseteq F\backslash{i}}\frac{|S|!(|F|-|S|-1)!}{|F|!}[f_{S\cup{i}}(x_{S\cup{i}})-f_{S(x_S)}]$$
åŸºäºä¸Šé¢å…¬å¼ç²¾ç¡®è®¡ç®—å¾ˆéº»çƒ¦ï¼Œç‰¹å¾çš„æ’åˆ—æœ‰$2^F$ç§ï¼Œè®¡ç®—é‡å·¨å¤§</p><h2 id=shap>SHAP</h2><p>SHAPåˆ†ä¸ºæ¨¡å‹æ— å…³å’Œæ¨¡å‹ç›¸å…³ä¸¤ç±»æ–¹æ³•ç”¨æ¥è¿‘ä¼¼æ±‚è§£ï¼Œæ¨¡å‹æ— å…³çš„ä»£è¡¨æ˜¯kernelSHAPï¼Œè€Œæ¨¡å‹ç›¸å…³çš„ä»£è¡¨åˆ™æœ‰DeepSHAPå’ŒTreeSHAPï¼Œä¸€ä¸ªæ˜¯é’ˆå¯¹æ·±åº¦å­¦ä¹ ï¼Œä¸€ä¸ªæ˜¯é’ˆå¯¹æ ‘æ¨¡å‹ã€‚</p><h2 id=kernel-shap>Kernel SHAP</h2><h3 id=lime>LIME</h3><p>LIME<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>ï¼ˆLocal interpretable model-agnostic explanations)ï¼ˆwhy should I trust you: Explaining the predictions of any classifierï¼‰é€šè¿‡ç”Ÿæˆçš„åŒ…å«éœ€è¦è§£é‡Šç‚¹å‘¨å›´çš„æ‰°åŠ¨æ•°æ®å’ŒåŸºäºé»‘ç®±æ¨¡å‹é¢„æµ‹ç»“æœçš„æ•°æ®é›†ï¼Œè®­ç»ƒä¸€ä¸ªå¯ä»¥è§£é‡Šçš„æ¨¡å‹ï¼Œæ¯”å¦‚é€»è¾‘å›å½’ã€å†³ç­–æ ‘ï¼Œè¿™ä¸ªå¯è§£é‡Šæ¨¡å‹éœ€è¦åœ¨è§£é‡Šç‚¹å‘¨å›´è¾¾åˆ°è¾ƒå¥½çš„æ•ˆæœã€‚
$$\xi = \mathop{\arg\min}\limits_{g\in G}L(f,g,\pi_x) + \Omega(g)$$</p><ul><li>fä¸ºéœ€è§£é‡Šæ¨¡å‹</li><li>gä¸ºå¯èƒ½çš„è§£é‡Šæ¨¡å‹</li><li>$\pi_x$ä¸ºå®šä¹‰å®ä¾‹å‘¨å›´å¤šå¤§èŒƒå›´</li></ul><p>ç®—æ³•è¿‡ç¨‹ï¼š</p><ul><li>é€‰æ‹©éœ€è¦è§£é‡Šæ„Ÿå…´è¶£çš„å®ä¾‹</li><li>å¯¹å…¶è¿›è¡Œæ‰°åŠ¨ï¼Œå¹¶å¾—åˆ°é»‘ç®±æ¨¡å‹å¯¹åº”ç»“æœäº§ç”Ÿæ–°æ•°æ®é›†</li><li>æ ¹æ®ä¸å®ä¾‹çš„æ¥è¿‘ç¨‹åº¦ï¼Œå¯¹æ–°æ•°æ®é›†è¿›è¡Œèµ‹äºˆæƒé‡</li><li>åŸºäºæ–°æ•°æ®é›†å’Œä¸Šè¿°æŸå¤±å‡½æ•°æ±‚è§£å¯è§£é‡Šæ¨¡å‹</li><li>è§£é‡Šé¢„æµ‹å€¼
<img src=https://cdn.jsdelivr.net/gh/jmwyf/pichosting@master/weightshap.png loading=lazy>
Figure 3: Toy example to present intuition for LIME</li></ul><h3 id=kernelshaplinear-lime--shapley-value>KernelSHAPï¼ˆLinear LIME + Shapley valueï¼‰</h3><p>LIMEï¼ˆLocal interpretable model-agnostic explanationsï¼‰æ–¹æ³•çš„æ‹“å±•ï¼Œé€šè¿‡ä¿®æ”¹LIMEéœ€è¦æ±‚è§£lossç­‰å¼å‚æ•°ï¼Œå…¶ä¸»è¦æ€è·¯æ˜¯åˆ©ç”¨æ ¸å˜æ¢ï¼Œè®©$\phi$ç¬¦åˆshapley value<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>
ç®—æ³•è¿‡ç¨‹<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>ï¼š</p><ul><li>æ ¹æ®$z_k^{&rsquo;} \in {0, 1}^M$é€‰æ‹©kä¸ªæ ·æœ¬</li><li>å°†$z_k^{&rsquo;} \in {0, 1}^M$è½¬åŒ–ä¸ºåŸå§‹ç‰¹å¾å€¼å¹¶è®¡ç®—é»‘ç®±æ¨¡å‹é¢„æµ‹å€¼</li><li>åŸºäºSHAP kernelè®¡ç®—$z_k^{&rsquo;}$ æ ·æœ¬æƒé‡ï¼Œ$z_k$é‡Œé¢1çš„ä¸ªæ•°ä¸ä¸€æ ·æƒé‡å°±ä¸ä¸€æ ·</li><li>æ‹Ÿåˆçº¿æ€§æ¨¡å‹</li><li>ä»çº¿æ€§æ¨¡å‹ä¸­è¿”å›Shapley values
SHAPæ ¸ä¸º(æ¨å¯¼è¿‡ç¨‹è§2è¡¥å……ææ–™)ï¼š
$$\pi_{x&rsquo;}(z&rsquo;)= \frac{(M-1)}{(M choose |z&rsquo;|)|z&rsquo;|(M-|z&rsquo;|)}$$
$$L(f,g, \pi_{x&rsquo;})=\sum_{z&rsquo;\in Z}[f(h_x^{-1}(z&rsquo;))-g(z&rsquo;)]^2\pi_{x&rsquo;}(z&rsquo;)$$
x&rsquo;ä¸ºç®€åŒ–è¾“å…¥ï¼Œ$x=h_x(x&rsquo;)$, $z&rsquo; \subseteq x&rsquo;$
å…¶ä¸­ç¬¬äºŒæ­¥ï¼šThe functionÂ hÂ maps 1â€™s to the corresponding value from the instance x that we want to explain. For tabular data, it maps 0â€™s to the values of another instance that we sample from the data. This means that we equate â€œfeature value is absentâ€ with â€œfeature value is replaced by random feature value from dataâ€.</li></ul><h2 id=deep-shap>Deep SHAP</h2><h3 id=deepliftlearning-important-features>DeepLIFTï¼ˆLearning Important FeaTuresï¼‰</h3><p>DeepLIFT<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>æ–¹æ³•ä½¿ç”¨ç¥ç»å…ƒçš„æ¿€æ´»ä¸å…¶â€œå‚è€ƒâ€è¿›è¡Œæ¯”è¾ƒï¼Œå…¶ä¸­å‚è€ƒæ˜¯ç¥ç»å…ƒåœ¨ç½‘ç»œè·å¾—â€œå‚è€ƒè¾“å…¥â€æ—¶å…·æœ‰çš„æ¿€æ´»çŠ¶æ€ï¼ˆå‚è€ƒè¾“å…¥æ ¹æ®å…·ä½“ä»»åŠ¡çš„å†…å®¹å®šä¹‰ï¼‰ã€‚è¯¥æ–¹æ³•èµ‹äºˆæ¯ä¸ªç‰¹å¾é‡è¦åº¦åˆ†æ•°ä¹‹å’Œç­‰äºé¢„æµ‹å€¼ä¸åŸºäºå‚è€ƒè¾“å…¥çš„é¢„æµ‹å€¼ä¹‹é—´çš„å·®å¼‚<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>ã€‚
èƒ½è§£å†³åŸºäºæ¢¯åº¦æ–¹æ³•çš„ä¸è¶³ï¼Œä¾‹å¦‚å‚è€ƒçš„å·®å¼‚ä¸æ˜¯0çš„æƒ…å†µä¸‹æ¢¯åº¦ä»ç„¶å¯èƒ½æ˜¯0ã€‚
$$\sum_{i=1}^n C_{\Delta x_i \Delta t} = \Delta t \tag1$$
$\Delta t = t - t^0$, ç¥ç»å…ƒè¾“å‡ºä¸å‚è€ƒè¾“å‡ºçš„å·®å¼‚ï¼Œ$\Delta x$è¾“å…¥ç›¸å¯¹å‚è€ƒè¾“å…¥çš„å˜åŒ–ï¼Œ Cå³ç‰¹å¾çš„è´¡çŒ®</p><p>$$m_{\Delta x\Delta t} = \frac{C_{\Delta x\Delta t}}{\Delta x} \tag2$$
å®šä¹‰ä¹˜å­multiplierï¼Œæ»¡è¶³é“¾å¼æ³•åˆ™
ç®—æ³•æ­¥éª¤<sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>ï¼š</p><ul><li>å®šä¹‰å‚è€ƒå€¼<ul><li>choosing a good reference would rely on domain-specific knowledge, and in some cases it may be best to compute DeepLIFT scores against multiple different references</li><li>æ¯”å¦‚å›¾åƒç”¨å…¨0æˆ–è€…æ¨¡ç³Šç‰ˆæœ¬ï¼ŒåŸºå› æ•°æ®ç”¨æœ¬åº•æœŸæœ›é¢‘ç‡</li></ul></li><li>åŒºåˆ†æ­£è´Ÿè´¡çŒ®ï¼ˆ2019ï¼‰</li><li>è´¡çŒ®åº¦è§„åˆ™<ul><li>çº¿æ€§å±‚ç›´æ¥æ˜¯ç³»æ•°$w* \Delta x_i$</li><li>éçº¿æ€§å˜åŒ–æ˜¯$m_{\Delta x\Delta y} = \frac{C_{\Delta x\Delta y}}{\Delta x} =\frac{\Delta y}{\Delta x}$</li></ul></li></ul><h3 id=deepshapdeeplift--shapley-value>DeepSHAP(DeepLIFT + Shapley value)</h3><p>å°½ç®¡kernelSHAPæ˜¯é€‚ç”¨äºæ‰€æœ‰æ¨¡å‹çš„åŒ…æ‹¬æ·±åº¦å­¦ä¹ æ¨¡å‹çš„ä¸€ç§å¯è§£é‡Šæ–¹æ³•ï¼Œä½†æ˜¯æœ‰æ²¡æœ‰èƒ½åˆ©ç”¨ç¥ç»ç½‘ç»œç‰¹æ€§çš„å¯è§£é‡Šæ–¹æ³•ä»è€Œæé«˜è®¡ç®—æ•ˆç‡ã€‚
DeepLIFTè®¡ç®—çš„åˆ†æ•°è¿‘ä¼¼äºShapley value?å¹¶ä¸æ˜¯è¿™ä¸ªæ€è·¯</p><ul><li>the Shapely values measure the average marginal effect of including an input over all possible orderings in which inputs can be included. If we define â€œincludingâ€ an input as setting it to its actual value instead of its reference value, DeepLIFT can be thought of as a fast approximation of the Shapely values<sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup></li><li>Though a variety of methods exist for estimating SHAP values, we implemented a modified version of the DeepLIFT algorithm, which computes SHAP by estimating differences in model activations during backpropagation relative to a standard reference.
<img src=https://cdn.jsdelivr.net/gh/jmwyf/pichosting@master/components.png loading=lazy>
<img src=https://cdn.jsdelivr.net/gh/jmwyf/pichosting@master/shap.png loading=lazy>
figure from ref[3]</li><li>åŸºäºShapley valueçš„å®šä¹‰ä»¥åŠå…¬å¼å¯ä»¥çœ‹å‡ºé‡è¦çš„ä¸€éƒ¨åˆ†å³è¾¹é™…æ•ˆåº”ï¼Œå³æ¨¡å‹åŒ…å«è¯¥ç‰¹å¾å‡å»æœªåŒ…å«è¯¥éƒ¨åˆ†ã€‚åœ¨ä¸Šè¿°ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å—é‡Œé¢ï¼Œç‰¹å¾é¡ºåºé€‰æ‹©éƒ½ä¸å­˜åœ¨ã€‚åœ¨è®¤ä¸ºåŒ…å«ç‰¹å¾å³ç›¸å¯¹äºå‚è€ƒè¾“å…¥æ˜¯çœŸå®è¾“å…¥çš„æƒ…å†µä¸‹ï¼ŒæŠŠåŒ…å«ç‰¹å¾åä¹˜å­ç›´æ¥é“¾å¼æ³•åˆ™åšä¸ºSHAPå€¼è¿‘ä¼¼å…¬å¼</li><li>åœ¨ä¸Šè¿°ç®€å•ç½‘ç»œç»„ä»¶é‡Œé¢ï¼Œè¾“å…¥åˆ°è¾“å‡ºä¹‹é—´å¯ä»¥çœ‹ä½œçº¿æ€§è¿‘ä¼¼ä»è€Œå¾—åˆ°å…¬å¼16</li><li>æŠŠç”¨å®é™…å€¼ä»£æ›¿å‚è€ƒå€¼çœ‹ä½œæ˜¯åŒ…å«æŸä¸ªç‰¹å¾ï¼ŒDeepLIFTæ–¹æ³•ä¸DeepSHAPä¼¼ä¹çœ‹ä¸åˆ°åŒºåˆ«?</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a class=link href=https://blog.ml.cmu.edu/2020/08/31/6-interpretability/ target=_blank rel=noopener>6 â€“ Interpretability â€“ Machine Learning Blog | ML@CMU | Carnegie Mellon University</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>Ribeiro, M. T., Singh, S. & Guestrin, C. â€˜Why Should I Trust You?â€™: Explaining the Predictions of Any Classifier. <em>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em> 1135â€“1144 (2016) doi:<a class=link href=https://doi.org/10.1145/2939672.2939778 target=_blank rel=noopener>10.1145/2939672.2939778</a>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a class=link href=https://papers.nips.cc/paper/2017/hash/8a20a8621978632d76c43dfd28b67767-Abstract.html target=_blank rel=noopener>A Unified Approach to Interpreting Model Predictions</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a class=link href=https://christophm.github.io/interpretable-ml-book/shap.html target=_blank rel=noopener>9.6 SHAP (SHapley Additive exPlanations) | Interpretable Machine Learning</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a class=link href=https://libraries.io/pypi/deeplift target=_blank rel=noopener>deeplift 0.6.13.0 on PyPI - Libraries.io</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a class=link href=https://towardsdatascience.com/explainable-neural-networks-recent-advancements-part-3-6a838d15f2fb target=_blank rel=noopener>Explainable Neural Networks: Recent Advancements, Part 3 | by G Roshan Lal | Towards Data Science</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p>Shrikumar, A., Greenside, P., Shcherbina, A. & Kundaje, A. Not Just a Black Box: Learning Important Features Through Propagating Activation Differences. Preprint at <a class=link href=https://doi.org/10.48550/arXiv.1605.01713 target=_blank rel=noopener>https://doi.org/10.48550/arXiv.1605.01713</a> (2017).&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:8><p>Shrikumar, A., Greenside, P. & Kundaje, A. Learning Important Features Through Propagating Activation Differences. Preprint at <a class=link href=http://arxiv.org/abs/1704.02685 target=_blank rel=noopener>http://arxiv.org/abs/1704.02685</a> (2019).&#160;<a href=#fnref:8 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></section><footer class=article-footer><section class=article-tags><a href=/tags/machine-learning/>machine learning</a>
<a href=/tags/shap/>SHAP</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/%E9%87%8D%E8%AF%BBxgboost/><div class=article-image><img src=/images/xgboost/algorithm1.jpg loading=lazy data-key data-hash=/images/xgboost/algorithm1.jpg></div><div class=article-details><h2 class=article-title>é‡è¯»XGBoost</h2></div></a></article></div></div></aside><div id=cusdis_thread data-host=https://cusdis.com data-app-id=1cfc2662-243a-4573-b9e7-8b2b4a986fba data-page-id=b5fdf24690e6a0c92d881929cb8f7c5e data-page-url=https://jmwyf.github.io/p/a-unified-approach-to-interpreting-model-predictions%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/ data-page-title="ã€ŠA Unified Approach to interpreting Model Predictionsã€‹è®ºæ–‡è§£è¯»"></div><script async defer src=https://cusdis.com/js/cusdis.es.js></script>
<script>function setCusdisTheme(e){let t=document.querySelector("#cusdis_thread iframe");t&&window.CUSDIS.setTheme(e)}window.addEventListener("onColorSchemeChange",e=>{setCusdisTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2019 -
2023 ä»ç™¾è‰å›­åˆ°ä¸‰å‘³ä¹¦å±‹</section><section class=powerby>his history is history<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>